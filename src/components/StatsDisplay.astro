---
// Component to display dynamic stats with fallbacks
import { getAllStats } from "../utils/stats";

let stats;
try {
  console.log("Fetching stats at build time...");
  stats = await getAllStats();
  console.log("Successfully fetched stats:", stats);
} catch (error) {
  console.error("Failed to load stats, using fallbacks:");
  console.error("Error type:", error?.constructor?.name);
  console.error("Error message:", (error as Error)?.message || "Unknown error");
  console.error("Full error:", error);
  stats = {
    crates: "1000+",
    stars: "13.4k",
    downloads: "7.1M",
  };
}
---

<div class="flex flex-wrap gap-5 pt-5 text-xl landing-mono font-bold text-slate-300">
  <span>
    <a
      class="no-underline"
      href="https://crates.io/crates/ratatui/reverse_dependencies"
      target="_blank"
      rel="noopener noreferrer"
    >
      <span class="text-black dark:text-white bg-slate-100 dark:bg-slate-900 p-2 px-4 m-2 landing-mono glitch-container">
        <span class="btn-slide relative">{stats.crates}</span>
      </span>
    </a> üì¶ crates built with Ratatui
  </span>
  <span>
    <a class="no-underline" href="https://github.com/ratatui-org/ratatui" target="_blank" rel="noopener noreferrer">
      <span class="text-black dark:text-white bg-slate-100 dark:bg-slate-900 p-2 px-4 m-2 landing-mono glitch-container">
        <span class="btn-slide relative">{stats.stars}</span>
      </span>
    </a> ‚≠ê stars on GitHub
  </span>
  <span>
    <a class="no-underline" href="https://crates.io/crates/ratatui" target="_blank" rel="noopener noreferrer">
      <span class="font-bold text-black dark:text-white bg-slate-100 dark:bg-slate-900 p-2 px-4 m-2 landing-mono glitch-container">
        <span class="btn-slide relative">{stats.downloads}</span>
      </span>
    </a> ‚¨áÔ∏è downloads on crates.io
  </span>
</div>
